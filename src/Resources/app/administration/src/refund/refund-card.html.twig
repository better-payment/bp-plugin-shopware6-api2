{% block sw_order_detail_base_line_items_card %}
    {% parent %}
    <sw-card
            v-if="cardIsVisible"
            :title="$tc('betterpayment.refund.cardTitle')">
        <template #grid>
            <sw-card-section divider="bottom" :slim="true">
                <sw-container v-if="isFullyRefunded">
                    <sw-label variant="success">
                        {{ $tc('betterpayment.refund.labels.noMoreRefunds') }}
                    </sw-label>
                </sw-container>
                <sw-container columns="1fr 1fr" gap="0px 14px">
                    <sw-container rows="1fr 1fr 1fr" gap="10px 0px">
                        <sw-number-field
                                required numberType="float" :digits="2" :allowEmpty="false" size="small"
                                :disabled="!canCreateRefund || isFullyRefunded"
                                :label="$tc('betterpayment.refund.labels.amount')"
                                v-model="refund.amount">
                        </sw-number-field>
                        <sw-datepicker
                                size="small" :label="$tc('betterpayment.refund.labels.date')"
                                :disabled="!canCreateRefund || isFullyRefunded"
                                v-model="refund.execution_date">
                        </sw-datepicker>
                        <sw-text-field
                                :copyable="true" :copyableTooltip="true" disabled size="small"
                                v-model="betterPaymentTransactionId">
                            <template v-slot:label>{{ $tc('betterpayment.refund.labels.transactionId') }}</template>
                        </sw-text-field>
                    </sw-container>
                    <sw-textarea-field
                            type="textarea" size="small"
                            :disabled="!canCreateRefund || isFullyRefunded"
                            :label="$tc('betterpayment.refund.labels.comment')"
                            v-model="refund.comment">
                    </sw-textarea-field>
                </sw-container>
                <sw-button-process
                        style="float: right"
                        :processSuccess="processSuccess"
                        :disabled="buttonDisabled || !canCreateRefund || isFullyRefunded"
                        @click="createRefund"
                        variant="ghost"
                        size="small"
                        @process-finish="createRefundFinished">
                    {{ $tc('betterpayment.refund.actions.createNew') }}
                </sw-button-process>
            </sw-card-section>
            <sw-data-grid
                    :isLoading="isLoading"
                    :showSelection="false" :showActions="false"
                    :dataSource="refunds" v-if="refunds.length !== 0"
                    :columns="[
                        { property: 'amount', label: $tc('betterpayment.refund.labels.amount') },
                        { property: 'message', label: $tc('betterpayment.refund.labels.comment') },
                        {# TODO: parse it according to shop setting for datetime #}
                        { property: 'created_at', label: $tc('betterpayment.refund.labels.date') }
                    ]">
            </sw-data-grid>
        </template>
    </sw-card>
{% endblock %}